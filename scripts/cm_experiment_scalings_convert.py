import math

training_until=10

opt = True
simple_alpha=False
p_to_print = 3

def get_c_alpha(ll):
    
    if simple_alpha:
    
        nom=0.
        den=0.
        for (l, dim) in ll:
            nom += math.log2(l)*dim
            den += dim*dim

        return (0, nom/den)       

    else:

        sum_yi=0.
        sum_xi=0.
        sum_xi2=0.
        sum_xi_yi=0.
        
        for (l, dim) in ll:
            sum_yi += math.log2(l)
            sum_xi+=dim
            sum_xi2+=dim*dim
            sum_xi_yi+=math.log2(l)*dim

        a = (sum_yi*sum_xi2-sum_xi*sum_xi_yi)/(len(ll)*sum_xi2-sum_xi*sum_xi)
        b = (len(ll)*sum_xi_yi-sum_xi*sum_yi)/(len(ll)*sum_xi2-sum_xi*sum_xi)
    
    return (a,b)

"""
#p=5 opt
ms=[4, 5, 6, 7, 8, 9, 10]
ys={"CMQAOA": [(0.723009, 0.049707), (0.544804, 0.107507), (0.285667, 0.064178), (0.166323, 0.067430), (0.104293, 0.036702), (0.044043, 0.026872), (0.044153, 0.016575)], "QAOA non_pen": [(0.921104, 0.014166, 0.132189), (0.815337, 0.037500, 0.135860), (0.794894, 0.018986, 0.157178), (0.662881, 0.056497, 0.188423), (0.583473, 0.023190, 0.131811), (0.394155, 0.053704, 0.137061), (0.237049, 0.028415, 0.087264)]}
alphas={"CMQAOA": -0.743267, "QAOA non_pen": -0.300639}


#p=6 nonopt
ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.062131526581261, 0.053171443360565), (0.042361037921563, 0.039126017332076), (0.025106329392995, 0.027049821365501), (0.009951130041194, 0.008805968482579), (0.005680856091009, 0.007024683322098), (0.003212812227478, 0.005005843569609), (0.002139803889414, 0.002980994793726), (0.000908166007609, 0.001184623864794), (0.000354087743280, 0.000448570356765), (0.000182969891259, 0.000269727252412), (0.000068978477915, 0.000089705261043), (0.000053001045964, 0.000061525337146), (0.000024663074768, 0.000044529600427), (0.000012952524435, 0.000023574863505), (0.000005613406895, 0.000009663077187), (0.000002324332643, 0.000003703378048), (0.000001737520347, 0.000003321610537), (0.000000679090547, 0.000001381482106), (0.000000299052505, 0.000000390683234)], "QAOA non_pen": [(0.101205976375439, 0.126559619259956, 0.106813085889225), (0.070040584334912, 0.076301325770771, 0.085538173548004), (0.041905247759879, 0.045762008543665, 0.066346922773452), (0.031058208682805, 0.037561572172144, 0.054292423543429), (0.014428169678434, 0.017766335567674, 0.022351704747930), (0.013207720431509, 0.011756518929308, 0.031248909845067), (0.005473848115603, 0.004237963181524, 0.009784698139710), (0.002171633976757, 0.002653446238890, 0.003361814151718), (0.001321614675889, 0.001426698142281, 0.002369010898512), (0.001218416455974, 0.001563073423622, 0.002953777711673), (0.000713665903502, 0.000579342709351, 0.001546250799635), (0.000403131081713, 0.000290745345026, 0.000912779813577), (0.000143923313222, 0.000247727518237, 0.000239954376236), (0.000055043504530, 0.000084441035449, 0.000124009457707), (0.000096305075240, 0.000061338915188, 0.000397712061629), (0.000043115726847, 0.000022206361025, 0.000173652591440), (0.000013494585262, 0.000013046423753, 0.000025881730669), (0.000005341789421, 0.000008995186342, 0.000010496365998), (0.000003564430467, 0.000002342487552, 0.000009693631738)]}
alphas={"CMQAOA": -0.994970, "QAOA non_pen": -0.824534}

#p=5 nonopt
ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.074301156534057, 0.052238922137476), (0.035938277063195, 0.031229079660114), (0.021807694499186, 0.020296425896745), (0.013782602439088, 0.014842171436949), (0.005589929615606, 0.006075201183413), (0.003674584095036, 0.003715096099627), (0.002007052997033, 0.003435094050758), (0.000583032173778, 0.000717000697916), (0.000421030406184, 0.000660670577336), (0.000171387584681, 0.000216710520618), (0.000105423574034, 0.000152097391712), (0.000041344009846, 0.000054542422763), (0.000023242602167, 0.000038777062670), (0.000009769397054, 0.000012220609837), (0.000005991248592, 0.000010339585946), (0.000002921014560, 0.000004753291124), (0.000001522178823, 0.000003376855406), (0.000000699440565, 0.000001179953450), (0.000000329254942, 0.000000520352920)], "QAOA non_pen": [(0.093077798080771, 0.086494748436276, 0.095594278517187), (0.060189694736914, 0.071020050407435, 0.074981299019417), (0.034490594403400, 0.031832503550724, 0.050745181622078), (0.026153752758369, 0.023217083864050, 0.039827792350066), (0.015188411717883, 0.017342177670548, 0.028355190450835), (0.008500504700648, 0.010968196560070, 0.012008811034643), (0.005485895256793, 0.005889970891171, 0.008943812479784), (0.003503763430274, 0.003818297371717, 0.005559952229631), (0.001239043461714, 0.001650180452728, 0.002021261105945), (0.001474021619382, 0.001615182649494, 0.003693139698692), (0.000509645507511, 0.000360225366772, 0.001218702053901), (0.000313555885975, 0.000484301720392, 0.000529883307687), (0.000261892757475, 0.000122670425176, 0.001171765005574), (0.000102992360608, 0.000104411858317, 0.000279588446487), (0.000115759674231, 0.000087628421185, 0.000323203221727), (0.000049556269158, 0.000049210837192, 0.000127714710029), (0.000023205495727, 0.000023672433890, 0.000124576935578), (0.000005899412562, 0.000008018578715, 0.000013476399907), (0.000003503535528, 0.000004625873329, 0.000010528832701)]}
alphas={"CMQAOA": -0.995780, "QAOA non_pen": -0.787531}

#p=10 nonopt
ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.055602993318489, 0.050337642250929), (0.023471512604244, 0.023398182929497), (0.013708726973098, 0.015905185347545), (0.007751463203354, 0.007752657519972), (0.003540689951701, 0.004184254779319), (0.002024562781129, 0.002244743298566), (0.001710027375134, 0.001600949966354), (0.000455190451413, 0.000500850252713), (0.000222271861874, 0.000235448001241), (0.000107143227234, 0.000114397165824), (0.000052914012792, 0.000054268605756), (0.000029585750337, 0.000028549022342), (0.000017728265642, 0.000021105210605), (0.000007982282429, 0.000008317585016), (0.000003644472145, 0.000004282985985), (0.000002575231474, 0.000003993815101), (0.000001041977949, 0.000001070521603), (0.000000382540991, 0.000000360627603), (0.000000265943419, 0.000000278718812)], "QAOA non_pen": [(0.164398103108568, 0.082810545416345, 0.160574278315635), (0.112511753016763, 0.072042027485225, 0.122582855757591), (0.063544824969600, 0.046881491275539, 0.090187361173026), (0.046376108841214, 0.042452579311840, 0.065234759822193), (0.038444580935814, 0.025862115046651, 0.078794299722272), (0.023144215216641, 0.017933381068813, 0.037963602926510), (0.017183461179268, 0.009393472848663, 0.055577260529532), (0.007570648542060, 0.006730951561798, 0.013407583087639), (0.003132664607334, 0.002624794318331, 0.004946485932932), (0.001796456099507, 0.001629769624409, 0.003764825621555), (0.000622778829469, 0.000828186182754, 0.001278614977705), (0.000495826229071, 0.000444068034054, 0.000930614652715), (0.000311141489641, 0.000245677090862, 0.000820602686849), (0.000108828868496, 0.000202361759797, 0.000283499234874), (0.000087105007339, 0.000115028272805, 0.000194187382686), (0.000043104103404, 0.000062768944259, 0.000094588304408), (0.000015496852305, 0.000017684231552, 0.000037766488023), (0.000013031212585, 0.000014288264925, 0.000041183472833), (0.000004932566048, 0.000011278761434, 0.000012009061560)]}
alphas={"CMQAOA": -0.987229, "QAOA non_pen": -0.853829}

#p=5
ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.074301156534057, 0.052238922137476), (0.035938277063195, 0.031229079660114), (0.021807694499186, 0.020296425896745), (0.013782602439088, 0.014842171436949), (0.005589929615606, 0.006075201183413), (0.003674584095036, 0.003715096099627), (0.002007052997033, 0.003435094050758), (0.000583032173778, 0.000717000697916), (0.000421030406184, 0.000660670577336), (0.000171387584681, 0.000216710520618), (0.000105423574034, 0.000152097391712), (0.000041344009846, 0.000054542422763), (0.000023242602167, 0.000038777062670), (0.000009769397054, 0.000012220609837), (0.000005991248592, 0.000010339585946), (0.000002921014560, 0.000004753291124), (0.000001522178823, 0.000003376855406), (0.000000699440565, 0.000001179953450), (0.000000329254942, 0.000000520352920)], "QAOA non_pen": [(0.093077798080771, 0.086494748436276, 0.095594278517187), (0.060189694736914, 0.071020050407435, 0.074981299019417), (0.034490594403400, 0.031832503550724, 0.050745181622078), (0.026153752758369, 0.023217083864050, 0.039827792350066), (0.015188411717883, 0.017342177670548, 0.028355190450835), (0.008500504700648, 0.010968196560070, 0.012008811034643), (0.005485895256793, 0.005889970891171, 0.008943812479784), (0.003503763430274, 0.003818297371717, 0.005559952229631), (0.001239043461714, 0.001650180452728, 0.002021261105945), (0.001474021619382, 0.001615182649494, 0.003693139698692), (0.000509645507511, 0.000360225366772, 0.001218702053901), (0.000313555885975, 0.000484301720392, 0.000529883307687), (0.000261892757475, 0.000122670425176, 0.001171765005574), (0.000102992360608, 0.000104411858317, 0.000279588446487), (0.000115759674231, 0.000087628421185, 0.000323203221727), (0.000049556269158, 0.000049210837192, 0.000127714710029), (0.000023205495727, 0.000023672433890, 0.000124576935578), (0.000005899412562, 0.000008018578715, 0.000013476399907), (0.000003503535528, 0.000004625873329, 0.000010528832701)]}
alphas={"CMQAOA": -0.995780, "QAOA non_pen": -0.787531}

#p=5 most recent

ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.051346056541586, 0.046788419369872), (0.033898690945922, 0.031293889694518), (0.018036498840643, 0.017164188104613), (0.007443770757206, 0.007072616779407), (0.002756019494755, 0.003188961672958), (0.001718722063891, 0.001849906125379), (0.000980827918244, 0.001400950260505), (0.000508245409068, 0.000631860834301), (0.000247139398651, 0.000349553599466), (0.000135722604406, 0.000202810872167), (0.000068922757340, 0.000098628705614), (0.000032470750824, 0.000087183645498), (0.000014932932291, 0.000020633323580), (0.000009623695460, 0.000021383624209), (0.000004456216076, 0.000007955618320), (0.000002057359088, 0.000003949844640), (0.000001632258724, 0.000004979334558), (0.000000480093927, 0.000000994068848), (0.000000321714654, 0.000000511807396)], "QAOA non_pen": [(0.088421805068168, 0.097427382438133, 0.092663781589180), (0.040181743266571, 0.054039045359341, 0.053211231098293), (0.019294998846410, 0.022537384536769, 0.029721389820233), (0.014143559216067, 0.023485969133988, 0.025537857232487), (0.008436953890811, 0.016467610600155, 0.016733710484345), (0.004973034778207, 0.006194609678107, 0.008706976264899), (0.003803911618986, 0.004987951893838, 0.007303821757201), (0.001417933045724, 0.001337922204744, 0.002840056218974), (0.001285815555389, 0.001229784563061, 0.002948530028665), (0.000876306713938, 0.001024694528044, 0.002575793887301), (0.000307829278547, 0.000316634614271, 0.000615715605833), (0.000419991723263, 0.000334418175515, 0.001602395876327), (0.000132273167769, 0.000225770763153, 0.000373304950211), (0.000020773054891, 0.000023863204632, 0.000054802050776), (0.000049103237332, 0.000037517007738, 0.000202059353126), (0.000022245241110, 0.000005672811674, 0.000158159446111), (0.000003279652997, 0.000006170168594, 0.000009233383261), (0.000004390025936, 0.000004557368092, 0.000013642419033), (0.000001301156390, 0.000000650616828, 0.000003957364041)]}
alphas={"CMQAOA": -0.971126, "QAOA non_pen": -0.845842}


# p=5 random

ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.075043649363270, 0.050646194416952), (0.039394636904185, 0.038462656628707), (0.021639491210587, 0.017580212738569), (0.010142098584267, 0.009773756991504), (0.007258555771393, 0.008237515177198), (0.003040828372997, 0.003699733644901), (0.001748094652794, 0.002362049855269), (0.000591638811398, 0.000688910671786), (0.000380923376339, 0.000468796744560), (0.000168890658534, 0.000261074688207), (0.000095477023339, 0.000135916737533), (0.000044201483527, 0.000071413001501), (0.000018926714549, 0.000028228828097), (0.000008446058099, 0.000015474503518), (0.000003424631321, 0.000004148109927), (0.000002678492502, 0.000004351550835), (0.000001931781203, 0.000003848691570), (0.000000502728163, 0.000000940435977), (0.000000243883658, 0.000000395395381)], "QAOA non_pen": [(0.103384169535382, 0.107872935078350, 0.133669858359523), (0.057387749928062, 0.047480230935133, 0.070164931913083), (0.033235794191283, 0.029959124099830, 0.048356458657383), (0.025301294276895, 0.019264236197508, 0.041452626521575), (0.008712554096825, 0.007795560472524, 0.014002876317992), (0.006499435929084, 0.003226679694537, 0.011101833546140), (0.001833740048480, 0.002019056748663, 0.004220389845651), (0.001687847717498, 0.002021017191927, 0.003743899927502), (0.001218932804506, 0.001093077393174, 0.003187556015254), (0.000375848628371, 0.000392515099005, 0.000815649601233), (0.000194253743730, 0.000141472292007, 0.000786117448407), (0.000094741448904, 0.000123504949000, 0.000214783819759), (0.000031305864605, 0.000028797745116, 0.000081434165344), (0.000019276199501, 0.000022394164660, 0.000068619411043), (0.000007541533223, 0.000005547539597, 0.000016719325439), (0.000003712443274, 0.000004179653348, 0.000010298059895), (0.000001733621144, 0.000002304665070, 0.000003718153351), (0.000000880631890, 0.000001141068502, 0.000003116648496), (0.000000474943330, 0.000000688773337, 0.000001273157122)]}
alphas={"CMQAOA": -1.013874, "QAOA non_pen": -1.011493}


#p=5 random 75 75

ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
ys={"CMQAOA": [(0.065492474814823, 0.053046158356262), (0.038205860532518, 0.032078849750291), (0.018152088889681, 0.017951868173903), (0.011424359275099, 0.010590635455931), (0.004230225119825, 0.004539211306772), (0.002694892511911, 0.002856164295986), (0.001334579880622, 0.001428765267391), (0.000622916268198, 0.000734752807652), (0.000370114222297, 0.000516208822340), (0.000203507967404, 0.000315977282256), (0.000112217383533, 0.000188224586355), (0.000046973382507, 0.000057120536692), (0.000021815730839, 0.000026578194744), (0.000013237263468, 0.000018186399681), (0.000006037156868, 0.000009064380122), (0.000003780488902, 0.000005430070800), (0.000001229140296, 0.000002317488627), (0.000000786502122, 0.000001098500656), (0.000000504724180, 0.000001057276145)], "QAOA non_pen": [(0.137053755651136, 0.103675473265893, 0.111672088562557), (0.071581335443107, 0.043402481368260, 0.088608867864580), (0.028435079652397, 0.019009776294569, 0.052054630694758), (0.029301520677798, 0.019174583765384, 0.051061843004004), (0.010853851635726, 0.011547512025305, 0.023033319384728), (0.012997829480385, 0.006496121667966, 0.030366723034991), (0.006957065276141, 0.004342564933589, 0.018363724245011), (0.002203991713408, 0.002530070985592, 0.005023910474970), (0.000961786740270, 0.001067406315277, 0.003162333684425), (0.000663162896674, 0.000605084536765, 0.002508172901536), (0.000165066984623, 0.000157365036605, 0.000330599229157), (0.000167328631640, 0.000254240441196, 0.000375100760233), (0.000100968172256, 0.000109333491950, 0.000217382329617), (0.000031330533525, 0.000023713030278, 0.000092354654552), (0.000014747406558, 0.000015058863799, 0.000042906249519), (0.000010625322904, 0.000007038360828, 0.000037986787489), (0.000003288374391, 0.000002478600348, 0.000009704586973), (0.000001037308943, 0.000001222971303, 0.000002391857185), (0.000000504355544, 0.000000589451523, 0.000001754478095)]}
alphas={"CMQAOA": -0.962557, "QAOA non_pen": -0.985769}


"""
if opt:

    if p_to_print == 1:

        ms=[4, 5, 6, 7, 8, 9, 10]
        ys={"CMQAOA": [(0.288000523107524, 0.198468928910316), (0.200785079897868, 0.164446729940767), (0.099396997524981, 0.109954825877527), (0.062680799548145, 0.050082285583334), (0.030616217437090, 0.022598151754595), (0.022812386511588, 0.022196357984595), (0.019014726007058, 0.012179922425771)], "QAOA non_pen": [(0.928746917368023, 0.003268490670390, 0.116268417709149), (0.805267371006528, 0.003623093934674, 0.168337347045487), (0.714699510176272, 0.007634745498049, 0.165158728401461), (0.559528441237960, 0.004447865518446, 0.112773542731358), (0.530291389073559, 0.010962666823874, 0.154558671253592), (0.325742712917051, 0.014883775001713, 0.136513560095137), (0.169523901566773, 0.005052130814126, 0.071534307829224)]}

    elif p_to_print == 2:
        
        ms=[4, 5, 6, 7, 8, 9, 10]
        ys={"CMQAOA": [(0.384788803056053, 0.152107688857826), (0.260785425861386, 0.149745873799049), (0.178724333751539, 0.103965603497507), (0.088715943701222, 0.056232555563340), (0.057060187377424, 0.028559182539586), (0.034210018972285, 0.033362065436258), (0.031901582578429, 0.019128095956216)], "QAOA non_pen": [(0.955892012002580, 0.014725660166119, 0.041218942557418), (0.814607641378857, 0.003102305545301, 0.168603714105535), (0.772697368019390, 0.029107629189029, 0.160865475482072), (0.602017422434559, 0.003941933452494, 0.079539411416800), (0.608632180858495, 0.008964806636893, 0.087275922817502), (0.339448836337169, 0.024100773658196, 0.155396763800768), (0.187674677444977, 0.012502359476594, 0.076535303263158)]}

    elif p_to_print == 3:
    
        ms=[4, 5, 6, 7, 8, 9, 10]
        ys={"CMQAOA": [(0.636808796906915, 0.185448094032760), (0.387124606104121, 0.168009360680495), (0.228643625585030, 0.138361865801523), (0.119043538490856, 0.074634739101199), (0.067990837377009, 0.031103715710610), (0.044656610176103, 0.032350279427677), (0.040833412115211, 0.017095495249483)],
            "QAOA non_pen": [(0.926821738351250, 0.009892459987726, 0.086992494245534), (0.819311258115487, 0.005455210092962, 0.148412179927094), (0.762736205049727, 0.026993514775166, 0.179256064880953), (0.616783047050618, 0.037275963515382, 0.131902129933718), (0.598502843111248, 0.009476495137268, 0.134559687562294), (0.318727375633604, 0.023097820578890, 0.118243979072781), (0.194605397823720, 0.011782772540445, 0.088710034734905)]}
   

else:
    
    if p_to_print == 1:
        #p 1 random 75 75 CM and QAOA is inv_diff 80 80 and QAOA is inv diff
        ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
        ys={"CMQAOA": [(0.081036221064191, 0.059352237684242), (0.034077674176826, 0.030918829078371), (0.018792755761106, 0.019549379393404), (0.010404069888203, 0.013170788258780), (0.005201959937319, 0.006703395779504), (0.002689433865701, 0.003283038246394), (0.001776385785293, 0.002333420072509), (0.000576211268413, 0.000867949960927), (0.000388272456796, 0.000434282854890), (0.000153496354275, 0.000172199870572), (0.000134182431217, 0.000265242683575), (0.000071256211156, 0.000145813706056), (0.000026438874705, 0.000033452620505), (0.000014482470637, 0.000021294800143), (0.000007205190047, 0.000012480424094), (0.000003660804567, 0.000005763636919), (0.000001687360935, 0.000002049345005), (0.000000869508181, 0.000001253373134), (0.000000391523111, 0.000000572753249)],
            "QAOA non_pen": [(0.093077798080771, 0.086494748436276, 0.095594278517187), (0.060189694736914, 0.071020050407435, 0.074981299019417), (0.034490594403400, 0.031832503550724, 0.050745181622078), (0.026153752758369, 0.023217083864050, 0.039827792350066), (0.015188411717883, 0.017342177670548, 0.028355190450835), (0.008500504700648, 0.010968196560070, 0.012008811034643), (0.005485895256793, 0.005889970891171, 0.008943812479784), (0.003503763430274, 0.003818297371717, 0.005559952229631), (0.001239043461714, 0.001650180452728, 0.002021261105945), (0.001474021619382, 0.001615182649494, 0.003693139698692), (0.000509645507511, 0.000360225366772, 0.001218702053901), (0.000313555885975, 0.000484301720392, 0.000529883307687), (0.000261892757475, 0.000122670425176, 0.001171765005574), (0.000102992360608, 0.000104411858317, 0.000279588446487), (0.000115759674231, 0.000087628421185, 0.000323203221727), (0.000049556269158, 0.000049210837192, 0.000127714710029), (0.000023205495727, 0.000023672433890, 0.000124576935578), (0.000005899412562, 0.000008018578715, 0.000013476399907), (0.000003503535528, 0.000004625873329, 0.000010528832701)]}
        alphas={"CMQAOA": -0.951, "QAOA non_pen": -0.776}
    
    # p 2 
    
    elif p_to_print == 2:
    
        ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
        ys={"CMQAOA": [(0.077890570142208, 0.072159989245569), (0.039802215082263, 0.033514483539800), (0.025794791026917, 0.029045722544932), (0.015768974628641, 0.015907817259806), (0.008746928017427, 0.007785870237981), (0.004128105647593, 0.004478859693972), (0.003033736492033, 0.002926321448226), (0.001458125403901, 0.002232262959397), (0.000778376805277, 0.000815326881210), (0.000371628472408, 0.000437073683520), (0.000223518803924, 0.000276993859351), (0.000090292579565, 0.000131002304639), (0.000068817061149, 0.000102460256064), (0.000027841544178, 0.000038144992364), (0.000011408776180, 0.000017596426887), (0.000006068950148, 0.000010402115580), (0.000004481558651, 0.000011025847663), (0.000002097891048, 0.000003130285178), (0.000000713174019, 0.000001240748214)],
            "QAOA non_pen": [(0.166420981113052, 0.146205517955709, 0.174684263640005), (0.076285347031021, 0.100718930293550, 0.082609971337715), (0.061512128084863, 0.059349610300532, 0.077203454043021), (0.030002116163043, 0.038582518615563, 0.037187107631810), (0.024411218953388, 0.022278996250687, 0.042602638688927), (0.011428403046545, 0.015156015757489, 0.015148070195914), (0.007511538744691, 0.006818407962092, 0.015148909834122), (0.004525934075746, 0.004411679789010, 0.008107788737536), (0.003450929972296, 0.001963903702233, 0.015230418394822), (0.001511134905361, 0.002367632209510, 0.002642242597913), (0.001006374206994, 0.000916602424553, 0.003002333699832), (0.000587806668517, 0.000540163672851, 0.001407215603421), (0.000397375972540, 0.000332374605565, 0.001385694391992), (0.000139629587192, 0.000150843455435, 0.000416645515471), (0.000081352693084, 0.000089284125546, 0.000140614291227), (0.000115451772075, 0.000072122865488, 0.000351805221911), (0.000020212416885, 0.000040319940192, 0.000050394220483), (0.000034188213555, 0.000021461382536, 0.000120724554534), (0.000030214603558, 0.000019730621933, 0.000111128168865)]}
        alphas={"CMQAOA": 0.89187136, "QAOA non_pen": -0.787197}
    
    
        #75 75
        #ys={"CMQAOA": [(0.065492474814823, 0.053046158356262), (0.038205860532518, 0.032078849750291), (0.018152088889681, 0.017951868173903), (0.011424359275099, 0.010590635455931), (0.004230225119825, 0.004539211306772), (0.002694892511911, 0.002856164295986), (0.001334579880622, 0.001428765267391), (0.000622916268198, 0.000734752807652), (0.000370114222297, 0.000516208822340), (0.000203507967404, 0.000315977282256), (0.000112217383533, 0.000188224586355), (0.000046973382507, 0.000057120536692), (0.000021815730839, 0.000026578194744), (0.000013237263468, 0.000018186399681), (0.000006037156868, 0.000009064380122), (0.000003780488902, 0.000005430070800), (0.000001229140296, 0.000002317488627), (0.000000786502122, 0.000001098500656), (0.000000504724180, 0.000001057276145)],"QAOA non_pen": [(0.093077798080771, 0.086494748436276, 0.095594278517187), (0.060189694736914, 0.071020050407435, 0.074981299019417), (0.034490594403400, 0.031832503550724, 0.050745181622078), (0.026153752758369, 0.023217083864050, 0.039827792350066), (0.015188411717883, 0.017342177670548, 0.028355190450835), (0.008500504700648, 0.010968196560070, 0.012008811034643), (0.005485895256793, 0.005889970891171, 0.008943812479784), (0.003503763430274, 0.003818297371717, 0.005559952229631), (0.001239043461714, 0.001650180452728, 0.002021261105945), (0.001474021619382, 0.001615182649494, 0.003693139698692), (0.000509645507511, 0.000360225366772, 0.001218702053901), (0.000313555885975, 0.000484301720392, 0.000529883307687), (0.000261892757475, 0.000122670425176, 0.001171765005574), (0.000102992360608, 0.000104411858317, 0.000279588446487), (0.000115759674231, 0.000087628421185, 0.000323203221727), (0.000049556269158, 0.000049210837192, 0.000127714710029), (0.000023205495727, 0.000023672433890, 0.000124576935578), (0.000005899412562, 0.000008018578715, 0.000013476399907), (0.000003503535528, 0.000004625873329, 0.000010528832701)]}
        
        #p=6
        #ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
        #ys={"CMQAOA": [(0.079867504988478, 0.063613829882495), (0.042016963691093, 0.038949836032534), (0.024617503835009, 0.017668191964079), (0.012492598748523, 0.012543446678632), (0.008232979580189, 0.009135810445736), (0.002449922231260, 0.002808663207301), (0.001989679410483, 0.002796729522920), (0.000842107686150, 0.001024194194503), (0.000550233218115, 0.000708900076697), (0.000224097770546, 0.000333617353114), (0.000125680535861, 0.000174876403072), (0.000050675108181, 0.000069906894591), (0.000034360753531, 0.000061965019112), (0.000015326231617, 0.000021132784412), (0.000008313578552, 0.000011941833203), (0.000004854600756, 0.000009021682464), (0.000001706640203, 0.000002463397532), (0.000000843333052, 0.000001299644909), (0.000000555732673, 0.000000953624982)], "QAOA non_pen": [(0.139902710916233, 0.093477810543338, 0.139970295940907), (0.090472387143714, 0.054821917092215, 0.121228455010583), (0.040851811681345, 0.032754929839382, 0.066141345654596), (0.034079898657399, 0.031299662102402, 0.054261181146524), (0.012570104719298, 0.011589661436766, 0.025498378901458), (0.008998948421109, 0.007732399834196, 0.016683307981625), (0.005397761589395, 0.005209725762363, 0.013189563252855), (0.003244307490726, 0.002674499633660, 0.007683342620500), (0.001217165952173, 0.000924356132540, 0.002999876371083), (0.000610722313904, 0.000522032423528, 0.001612437662296), (0.000508660113247, 0.000266308552112, 0.001738152423003), (0.000219411130471, 0.000190110026913, 0.000925147862371), (0.000091487030839, 0.000088831842025, 0.000198855277184), (0.000054762476586, 0.000074568261604, 0.000158986042177), (0.000021294324443, 0.000012414950913, 0.000078966192182), (0.000009012196612, 0.000007585878424, 0.000021250552677), (0.000007951973879, 0.000005146935999, 0.000026633529026), (0.000001052398225, 0.000002382514165, 0.000002617279402), (0.000000712456957, 0.000001340717300, 0.000002543278548)]}
        #alphas={"CMQAOA": -0.965911, "QAOA non_pen": -0.963376}
        
        #p=3 QAOA non_pen invalid
    elif p_to_print == 3:
        
        """ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
        ys={"CMQAOA": [(0.088728241831448, 0.053610429934976), (0.033594778603812, 0.027762727449421), (0.025041456186225, 0.025197798626751), (0.013435319634736, 0.011815958170181), (0.007114854510383, 0.007635541534534), (0.003437091654332, 0.003871516556957), (0.002206860887128, 0.002820917638031), (0.001477343296846, 0.002408819404903), (0.000676747064387, 0.001085150304857), (0.000297464268866, 0.000407026989867), (0.000149783994839, 0.000172639591016), (0.000094817379654, 0.000188289928956), (0.000037457978074, 0.000059966785988), (0.000026846397540, 0.000044836919235), (0.000015159618364, 0.000021225532460), (0.000009175247753, 0.000017789900975), (0.000003743590747, 0.000006598673234), (0.000001754033774, 0.000002875454393), (0.000001083614741, 0.000002164392122)],
       "QAOA non_pen": [(0.139902710916233, 0.093477810543338, 0.139970295940907), (0.090472387143714, 0.054821917092215, 0.121228455010583), (0.040851811681345, 0.032754929839382, 0.066141345654596), (0.034079898657399, 0.031299662102402, 0.054261181146524), (0.012570104719298, 0.011589661436766, 0.025498378901458), (0.008998948421109, 0.007732399834196, 0.016683307981625), (0.005397761589395, 0.005209725762363, 0.013189563252855), (0.003244307490726, 0.002674499633660, 0.007683342620500), (0.001217165952173, 0.000924356132540, 0.002999876371083), (0.000610722313904, 0.000522032423528, 0.001612437662296), (0.000508660113247, 0.000266308552112, 0.001738152423003), (0.000219411130471, 0.000190110026913, 0.000925147862371), (0.000091487030839, 0.000088831842025, 0.000198855277184), (0.000054762476586, 0.000074568261604, 0.000158986042177), (0.000021294324443, 0.000012414950913, 0.000078966192182), (0.000009012196612, 0.000007585878424, 0.000021250552677), (0.000007951973879, 0.000005146935999, 0.000026633529026), (0.000001052398225, 0.000002382514165, 0.000002617279402), (0.000000712456957, 0.000001340717300, 0.000002543278548)]}  
        alphas={"CMQAOA": -0.899749}"""
        ms=[4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]
        ys={"CMQAOA": [(0.069329271671561, 0.052979587718531), (0.047868430786302, 0.037381545336635), (0.025032587157180, 0.023652483637020), (0.012698733015311, 0.010940024752456), (0.006938764219226, 0.007202205463881), (0.003528632980062, 0.004269744970614), (0.002098228447024, 0.002432489298470), (0.001306572466634, 0.001685594921208), (0.000613299263127, 0.000874995532098), (0.000257375431360, 0.000315848305735), (0.000192391958597, 0.000225554691590), (0.000088553454363, 0.000109583281228), (0.000035788810396, 0.000048610854314), (0.000030215802382, 0.000054175637054), (0.000015992320283, 0.000026017268467), (0.000012088429560, 0.000024324290072), (0.000003849468933, 0.000005873413040), (0.000001561551912, 0.000003257879576), (0.000001070103136, 0.000002432276325)],
        "QAOA non_pen": [(0.165984611064018, 0.103768837666343, 0.196745594738953), (0.105151678820791, 0.064714759570353, 0.144119681591286), (0.064928490474756, 0.052455573454085, 0.105909961626852), (0.053090081987033, 0.026578494668051, 0.094097641558927), (0.027641755260166, 0.027323655950475, 0.048060309311660), (0.017790118199533, 0.012818029664219, 0.045322358799883), (0.015235089200585, 0.010007399483770, 0.033451629920618), (0.004107937945639, 0.005977631041668, 0.006479939708259), (0.002438562043816, 0.002749551396777, 0.005775909704824), (0.002580992113209, 0.001469626212947, 0.006841013976825), (0.001015381168156, 0.001148065852912, 0.003404514419324), (0.000775562757545, 0.000953461338840, 0.002402792683741), (0.000633990577694, 0.000568355475683, 0.001673355576209), (0.000323446905075, 0.000178274417084, 0.000924768630572), (0.000169186701856, 0.000152563427306, 0.000534930844373), (0.000160533221516, 0.000152333374749, 0.000461628191583), (0.000074044101616, 0.000055401625546, 0.000231690351294), (0.000050112888975, 0.000049540481516, 0.000162475817974), (0.000035431019456, 0.000038859618948, 0.000153162666933)]}
    #"QAOA non_pen": [(0.144187548945931, 0.205776650322905, 0.149799236895733), (0.097258813288785, 0.087530128672345, 0.124550596506478), (0.061430394037958, 0.070272802037764, 0.095723698048930), (0.042900769901772, 0.046093016363267, 0.077460714454958), (0.033910929183005, 0.030511475261699, 0.060617737542168), (0.016871726477922, 0.016753076743209, 0.038251880943980), (0.012451566836280, 0.009629588788939, 0.023055982956569), (0.008449350064322, 0.006087534360585, 0.013465265231720), (0.004198457431587, 0.003437872049149, 0.006628348676897), (0.002922632314793, 0.003032379482225, 0.006505854017960), (0.001190636485697, 0.001076317424790, 0.002559756315242), (0.000608394305287, 0.000578949710062, 0.001536503892478), (0.000579729354476, 0.000479050971934, 0.001743512561851), (0.000212625236551, 0.000244467377980, 0.000642455792686), (0.000127437594968, 0.000118345804534, 0.000555855184636), (0.000052709678863, 0.000060767903843, 0.000098546444822), (0.000028664436393, 0.000042185656408, 0.000069068202294), (0.000046730118588, 0.000027308569659, 0.000157500755841), (0.000012988145655, 0.000013286778382, 0.000035126923270)]}
        alphas={"CMQAOA": -0.895274, "QAOA non_pen": 0.695429}


cm_overlaps = []
qaoa_overlaps = []

print("x cm_overlap_sv cm_overlap_std+ cm_overlap_std- qaoa_nonpen_overlap_sv qaoa_nonpen_overlap_std+ qaoa_nonpen_overlap_std- alpha_line_cm alpha_line_qaoa fixed_used_in_training fixed_used_in_training2 alpha_cm alpha_qaoa")
for i in range(len(ms)):
    cm_overlap=ys["CMQAOA"][i][0]
    qaoa_overlap=ys["QAOA non_pen"][i][0]
    
    cm_overlaps.append((cm_overlap, ms[i]))
    qaoa_overlaps.append((qaoa_overlap, ms[i]))

line_cm=get_c_alpha(cm_overlaps)
line_qaoa=get_c_alpha(qaoa_overlaps)

for i in range(len(ms)):
    cm_overlap=ys["CMQAOA"][i][0]
    qaoa_overlap=ys["QAOA non_pen"][i][0]
        
    e_min = ys["CMQAOA"][i][1]
    if e_min >= cm_overlap:
        e_min = cm_overlap - 0.0001
    e2_min = ys["QAOA non_pen"][i][2]
    if e2_min >= qaoa_overlap:
        e2_min = qaoa_overlap - 0.0001
    
    training2= 1
    training = 1
    if ms[i] > training_until:
        training = 0
    if ms[i] > training_until-1:
        training2 = 0
    
        
    print(ms[i], cm_overlap, ys["CMQAOA"][i][1], e_min, qaoa_overlap, ys["QAOA non_pen"][i][1], e2_min, 2**(line_cm[0]+ms[i]*line_cm[1]), 2**(line_qaoa[0]+ms[i]*line_qaoa[1]), training, training2, round(line_cm[1],3), round(line_qaoa[1],3))
print(31, 0, 0,0, 0, 0, 0, 2**(line_cm[0]+31*line_cm[1]), 2**(line_qaoa[0]+31*line_qaoa[1]), 0, 0, round(line_cm[1],3), round(line_qaoa[1],3))




    
